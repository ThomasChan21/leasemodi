<!DOCTYPE html>
<html>
<head>
	<title>Lease Modification 2013-2021</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="author" content="Thomas Chan">
    <link rel="stylesheet" href="css/leaflet.css">
    <script src="js/leaflet.js"></script>
    <script src="js/jquery.js"></script>
    <style>
        body {
            padding: 0;
            margin: 0;
        }
        html, body, #map {
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body>
	<div id="map"></div>
	<script>

// Tile layer
var osm = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'});
var imagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'});


// load GeoJSON from an external file
var url = "https://geodata.gov.hk/gs/api/v1.0.0/geoDataQuery?q=%7Bv%3A%221%2E0%2E0%22%2Cid%3Aa0401247-ac87-4ae8-8bc7-104c0b74ca39%2Clang%3A%22ENG%22%7D"


// Markers
var pnt2013 = L.layerGroup();
var pnt2014 = L.layerGroup();
var pnt2015 = L.layerGroup();
var pnt2016 = L.layerGroup();
var pnt2017 = L.layerGroup();
var pnt2018 = L.layerGroup();
var pnt2019 = L.layerGroup();
var pnt2020 = L.layerGroup();
var pnt2021 = L.layerGroup();

// Map
var map = L.map('map', {center: [22.39994, 114.12597], zoom: 11, 
	layers: [osm, pnt2013, pnt2014, pnt2015, pnt2016, pnt2017, pnt2018, pnt2019, pnt2020, pnt2021]});

$.getJSON(url, function(data) {
	$.each(data.features, function(key, value) {
		if (value.properties.premiumEN != "Nil" && value.properties.premiumEN != "1,000") {
			if (value.properties.executionYear == "2013") {
				L.geoJSON(value)
				.bindPopup("<b>Location: </b>" + value.properties.locationEN + "<br>" 
				+ "<b>Premium: $</b>" + value.properties.premiumEN + "<br>"
				+ "<b>User: </b>" + value.properties.userEN + "<br>"
				+ "<b>Execution Date: </b>" + value.properties.executionDateEN)
				.addTo(pnt2013);
			} else if (value.properties.executionYear == "2014") {
				L.geoJSON(value)
				.bindPopup("<b>Location: </b>" + value.properties.locationEN + "<br>" 
				+ "<b>Premium: $</b>" + value.properties.premiumEN + "<br>"
				+ "<b>User: </b>" + value.properties.userEN + "<br>"
				+ "<b>Execution Date: </b>" + value.properties.executionDateEN)
				.addTo(pnt2014);
			} else if (value.properties.executionYear == "2015") {
				L.geoJSON(value)
				.bindPopup("<b>Location: </b>" + value.properties.locationEN + "<br>" 
				+ "<b>Premium: $</b>" + value.properties.premiumEN + "<br>"
				+ "<b>User: </b>" + value.properties.userEN + "<br>"
				+ "<b>Execution Date: </b>" + value.properties.executionDateEN)
				.addTo(pnt2015);
			} else if (value.properties.executionYear == "2016") {
				L.geoJSON(value)
				.bindPopup("<b>Location: </b>" + value.properties.locationEN + "<br>" 
				+ "<b>Premium: $</b>" + value.properties.premiumEN + "<br>"
				+ "<b>User: </b>" + value.properties.userEN + "<br>"
				+ "<b>Execution Date: </b>" + value.properties.executionDateEN)
				.addTo(pnt2016);
			} else if (value.properties.executionYear == "2017") {
				L.geoJSON(value)
				.bindPopup("<b>Location: </b>" + value.properties.locationEN + "<br>" 
				+ "<b>Premium: $</b>" + value.properties.premiumEN + "<br>"
				+ "<b>User: </b>" + value.properties.userEN + "<br>"
				+ "<b>Execution Date: </b>" + value.properties.executionDateEN)
				.addTo(pnt2017);
			} else if (value.properties.executionYear == "2018") {
				L.geoJSON(value)
				.bindPopup("<b>Location: </b>" + value.properties.locationEN + "<br>" 
				+ "<b>Premium: $</b>" + value.properties.premiumEN + "<br>"
				+ "<b>User: </b>" + value.properties.userEN + "<br>"
				+ "<b>Execution Date: </b>" + value.properties.executionDateEN)
				.addTo(pnt2018);
			} else if (value.properties.executionYear == "2019") {
				L.geoJSON(value)
				.bindPopup("<b>Location: </b>" + value.properties.locationEN + "<br>" 
				+ "<b>Premium: $</b>" + value.properties.premiumEN + "<br>"
				+ "<b>User: </b>" + value.properties.userEN + "<br>"
				+ "<b>Execution Date: </b>" + value.properties.executionDateEN)
				.addTo(pnt2019);
			} else if (value.properties.executionYear == "2020") {
				L.geoJSON(value)
				.bindPopup("<b>Location: </b>" + value.properties.locationEN + "<br>" 
				+ "<b>Premium: $</b>" + value.properties.premiumEN + "<br>"
				+ "<b>User: </b>" + value.properties.userEN + "<br>"
				+ "<b>Execution Date: </b>" + value.properties.executionDateEN)
				.addTo(pnt2020);
			} else {
				L.geoJSON(value)
				.bindPopup("<b>Location: </b>" + value.properties.locationEN + "<br>" 
				+ "<b>Premium: $</b>" + value.properties.premiumEN + "<br>"
				+ "<b>User: </b>" + value.properties.userEN + "<br>"
				+ "<b>Execution Date: </b>" + value.properties.executionDateEN)
				.addTo(pnt2021);
			};	
		}
	});
});


// Layer control
var baseMaps = {
    "OSM": osm,
    "Imagery": imagery
};
var overlayMaps = {
    "modi2013": pnt2013,
	"modi2014": pnt2014,
	"modi2015": pnt2015,
	"modi2016": pnt2016,
	"modi2017": pnt2017,
	"modi2018": pnt2018,
	"modi2019": pnt2019,
	"modi2020": pnt2020,
	"modi2021": pnt2021
};
L.control.layers(baseMaps, overlayMaps, {position: "topleft", collapsed: false}).addTo(map);

	</script>
</body>
</html>

